<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Fleet Spawning - Reassembly Modding by Example</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Reassembly Modding by Example</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="fleet-spawning"><a class="header" href="#fleet-spawning">Fleet Spawning</a></h1>
<p>(Fleet spawning is surprisingly complex, but there has been so much misinformation and mods that have gone on to use fleet code "incorrectly", that even if you do not understand fleets at all, you probably won't even notice.)</p>
<!-- `fleetFraction` is the probability of a sector in the region containing a fleet.

`fleets` controls how much P is allocated to a fleet of a faction in a sector at different distances from the center of a region.

`fleetCount` controls the ranges of ship counts for each faction of a fleet. -->
<p>When a sector is generated in this region, it has <code>fleetFraction</code> (0.0-1.0) probability to spawn one type of fleet in from <code>fleets</code>.</p>
<p><code>fleets</code> is a list of fleet types. Each fleet type in <code>fleets</code> has a faction ID and also has a list of number pairs that represent the total P of fleets at different locations in the region. The 2nd number of the number pair is a P allocation distributed in a  fleet, and the 1st number being which distance from the center of the region that P allocation is for.</p>
<p>In other words, <code>fleets</code> controls how much P is allocated to a fleet of a faction in a sector at different distances from the center of a region.</p>
<p>Also, each fleet type's list of P allocations should have a value at 0.0 distance and at 1.0 distance.</p>
<p><code>fleetCount</code> is a list of ranges of ship numbers for the fleet type at the same index.</p>
<p>So, every time a fleet is spawned in a sector, a random number in the range of the relevant <code>fleetCount</code> element is chosen to decide how many ships will be in the fleet. Then, the relevant P allocation for the fleet (dependent on the sector's distance from the center of the region) is spread out between the number of ships in the fleet.</p>
<pre><code class="language-lua">    fleets={
		{ 98    -- Faction ID of the faction that can spawn
				-- in a sector in this region.
			{
				-- Each faction 98 fleet in the center of the region has 10000P total.
				{0.0,10000}

				-- Each faction 98 fleet 1/4 from the center of the region
				-- has (10000+3000)/2=6500P total.

				-- Each faction 98 fleet halfway into the region has 3000P total.
				{0.5, 3000}

				-- Each faction 98 fleet 1/4 from the edge of the region
				-- has (3000+1000)/2=2000P total.

				-- Each faction 98 fleet at the edge of the region has 1000P total.
				{1.0, 1000}
			}
		}
		{ 8     -- The Terrans (faction 8) could also spawn in this region.
			{ 
				{0.0,    0}
				-- No Terrans can spawn anywhere from the center
				-- to 80% of the region. It will all be faction 98.
				{0.8,    0}

				-- Increasing from 80% to 100% of the region,
				-- Terran fleets can begin to spawn in sectors.
				{1.0, 1000}
				-- At the edge of the region, each fleet has a maximum of 1000P total.
			}
		}
    }

	fleetCount={
		{4,8}	-- Each faction 98 fleet has 4 to 8 ships.
		{10,16} -- Each Terran fleet has 10 to 16 ships.
	}

				-- Every sector in this region has a 75% chance of spawning a
				-- faction 98 fleet and a 75% of spawning a Terran fleet.
	fleetFraction=0.75
</code></pre>
<h2 id="fleet-p-allocation-example"><a class="header" href="#fleet-p-allocation-example">Fleet P Allocation Example</a></h2>
<p>Below is an example of a unique region that exploits the P allocation curve of 2 factions, where bigger ships have more P.</p>
<pre><code class="language-lua">{
	fleets={
		{ 200 -- Red Colored Faction
			{
				{0.00,10000}
				{0.10, 5000}
				{0.25,    0}
				{0.75,    0}
				{0.90, 3000}
				{0.10, 5000}
			}
		}
		{ 300 -- Blue Colored Faction
			{
				{0.00,    0}
				{0.25,    0}
				{0.26,10000}
				{0.75, 8000}
				{0.76,    0}
				{0.10,    0}
			}
		}
	}
	fleetCount={
		{3,3}
		{3,3}
	}
	fleetFraction=1
	-- Other fields here.
}
</code></pre>
<p><img src="./diagrams/p_allocation_curve.jpg" alt="P Allocation Curve" />
<img src="./diagrams/regions_example_1.png" alt="Regions Example Galaxy" /></p>
<p>This shows how versatile regions are, but a better way of doing this that would have the same effect would be to use <a href="./subregions.html">subregions</a>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="regions.lua.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="unique_fleet_spawning.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="regions.lua.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="unique_fleet_spawning.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
